<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Upload to R2 (Direct)</title>
<style>
body{background:#111;color:#fff;font-family:sans-serif}
.box{max-width:500px;margin:50px auto;padding:20px;background:#1a1a1a;border-radius:10px}
progress{width:100%}
</style>
</head>
<body>

<div class="box">
<h2>Upload to R2 (Direct)</h2>

<input type="file" id="file">
<button onclick="upload()">Upload</button>

<br><br>
<progress id="p" value="0" max="100"></progress>
<div id="s"></div>
</div>

<!-- AWS SDK for browser (UMD build) -->
<script src="https://cdn.jsdelivr.net/npm/@aws-sdk/client-s3@3.470.0/dist/aws-sdk-client-s3.umd.min.js"></script>

<script>
const { S3Client, PutObjectCommand } = window.AwsSdkClientS3;

// ===== ĐIỀN THÔNG TIN CỦA BẠN =====
const ACCOUNT_ID = "f0cbfef63d7578a685f24d12e42c1143";
const ACCESS_KEY = "acffa193c2c871dbe4b47f49582019dd";
const SECRET_KEY = "0977f661664eec3284ae035978e5fcde45466b72a40afa5beadfe27672650efd";
const BUCKET = "videos";
// =================================

const client = new S3Client({
  region: "auto",
  endpoint: `https://${ACCOUNT_ID}.r2.cloudflarestorage.com`,
  credentials: {
    accessKeyId: ACCESS_KEY,
    secretAccessKey: SECRET_KEY
  }
});

async function upload() {
  const file = document.getElementById("file").files[0];
  if (!file) return alert("Chọn file");

  const key = Date.now() + "-" + file.name;

  document.getElementById("s").innerText = "Uploading...";

  try {
    const cmd = new PutObjectCommand({
      Bucket: BUCKET,
      Key: key,
      Body: file,
      ContentType: file.type
    });

    await client.send(cmd);

    document.getElementById("p").value = 100;
    document.getElementById("s").innerText = "✅ Upload thành công: " + key;

  } catch (e) {
    document.getElementById("s").innerText = "❌ Lỗi: " + e.message;
    console.error(e);
  }
}
</script>

</body>
</html>
